<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
        th:replace="~{layout :: layout(~{::content})}">
<div th:fragment="content">
    <h2 class="text-2xl font-semibold mb-4" th:text="${title}">Todo一覧</h2>

    <form th:action="@{/todos}" method="get" class="mb-4 flex gap-2">
        <input type="text" name="keyword" placeholder="タイトルで検索"
                th:value="${keyword}" class="border p-1 rounded w-60">
        <button type="submit" class="bg-blue-500 text-white px-3 py-1 rounded">検索</button>
    </form>

    <a th:href="@{/todos/new}" class="inline-block mb-3 text-blue-600 hover:underline">＋ 新規Todo作成</a>

    <table class="border-collapse border border-gray-400 w-full text-left">
        <thead>
        <tr class="bg-gray-100">
            <th class="border px-3 py-2">ID</th>
            <th class="border px-3 py-2">タイトル</th>
            <th class="border px-3 py-2">カテゴリ</th>
            <th class="border px-3 py-2">操作</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="todo : ${todos}">
            <td class="border px-3 py-2" th:text="${todo.id}"></td>
            <td class="border px-3 py-2" th:text="${todo.title}"></td>
            <td class="border px-3 py-2" th:text="${todo.category != null ? todo.category.name : '未分類'}"></td>
            <td class="border px-3 py-2">
                <a th:href="@{'/todos/' + ${todo.id}}" class="text-blue-600 hover:underline">詳細</a> |
                <a th:href="@{'/todos/edit/' + ${todo.id}}" class="text-green-600 hover:underline">編集</a> |
                <a th:href="@{'/todos/delete/' + ${todo.id}}" class="text-red-600 hover:underline"
                    onclick="return confirm('本当に削除しますか？');">削除</a>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</html>
